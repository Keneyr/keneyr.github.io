<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Rendering-Lighting-Shading-Texture - QinranY&#39;s Homepage</title>


    <meta name="description" content="Keywords: Surface Shading, Texture mapping">
<meta property="og:type" content="article">
<meta property="og:title" content="Rendering-Lighting-Shading-Texture">
<meta property="og:url" content="https://keneyr.com/Graphics/Rendering/Rendering-Lighting-Shading-Texture/index.html">
<meta property="og:site_name" content="QinranY&#39;s Homepage">
<meta property="og:description" content="Keywords: Surface Shading, Texture mapping">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://keneyr.com/images/og_image.png">
<meta property="article:published_time" content="2020-03-25T03:35:00.000Z">
<meta property="article:modified_time" content="2023-10-03T13:29:36.830Z">
<meta property="article:author" content="Keneyr">
<meta property="article:tag" content="Rendering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://keneyr.com/images/og_image.png">








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs2015.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/beauty.jpg" alt="Rendering-Lighting-Shading-Texture" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
                <a class="navbar-item"
                href="/publication">Publication</a>
                
                <a class="navbar-item"
                href="/projects">Projects</a>
                
                <a class="navbar-item"
                href="/life">Life</a>
                
                <a class="navbar-item"
                href="/work">Work</a>
                
                <a class="navbar-item"
                href="/Animation">Animation</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/CV">CV</a>
                
                <a class="navbar-item"
                href="/extra">Extra</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Keneyr">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-03-25T03:35:00.000Z">2020-03-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Graphics/">Graphics</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/Graphics/Rendering/">Rendering</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    44 minutes read (About 6667 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Rendering-Lighting-Shading-Texture
            
        </h1>
        <div class="content">
            <p><strong><em>Keywords</em></strong>: Surface Shading, Texture mapping</p>
<a id="more"></a>

<h2 id="How-to-Understand-Shading"><a href="#How-to-Understand-Shading" class="headerlink" title="How to Understand Shading?"></a>How to Understand Shading?</h2><p>How to understand shading? Just like everything does in the real world, all the scenes we see are under different ligths : the sun, the lamp, the flash light etc. Shading is kind of a technique that has a significant relationship with lights and will present the colorful drawings to us at last. Surface shading means the surface is ‘painted’ with lights, it’s a process of applying a material to an object.</p>
<h2 id="The-Standard-Local-Lighting-Model"><a href="#The-Standard-Local-Lighting-Model" class="headerlink" title="The Standard Local Lighting Model"></a>The Standard Local Lighting Model</h2><p>I bet that you have heard the term: <strong>BRDF(Bidirectional Reflectance Distribution Function)</strong> which seems to have inextricable linkes to the Standard Lighting Model. Yes,BRDF will appear in <strong>PBS(Physically Based Shading)</strong> which is used to make more realistic modeling presenting the reactions between lights and materials. As for Standard Local Lighting Model, they can be considered as simplified versions of PBS, they are empirical models, but they are easier to understand.</p>
<h3 id="The-Standard-Lighting-Equation-Overview"><a href="#The-Standard-Lighting-Equation-Overview" class="headerlink" title="The Standard Lighting Equation Overview"></a>The Standard Lighting Equation Overview</h3><p>The Standard Lighting Model only cares about <strong>direct light (direct reflection)</strong>.Lights are special entities without any corresponding geometry,and are simulated as if the light were emitting from a sight point. The rendering equation is an equation for the radiance outgoing from a point in any particular direction,the only outgoing direction that mattered in those days were the directions that pointed to the eye. Why say that? Because you know the real world doesn’t work like this where the light may reflect for dozens of times and the process is really complicated, the cost is also a luxury that could not yet be afforded.</p>
<p>The basic idea is to classify coming into the eye into four distinct categories, each of which has a unique method for calculating its contribution. The four categories are :</p>
<ul>
<li><p><strong>Emissive</strong> contribution,denoted as <strong>$c_{emis}$</strong>. It tells the amount of radiance emitted directly from the surface in the given direction. Note that without global illumination techniques,these surfaces do not actually light up anything(except themselves).</p>
</li>
<li><p><strong>Specular</strong> contribution,denoted as <strong>$c_{spc}$</strong>. It accounts for light incident directly from the light source that is scattered preferentially in the direction of a perfect “mirror bounce”.</p>
</li>
<li><p><strong>Diffuse</strong> contribution,denoted as <strong>$c_{diff}$</strong>. It accounts for light incident directly from the light source that is scattered in every direction evenly.</p>
</li>
<li><p><strong>Ambient</strong> contribution,denoted as <strong>$c_{amb}$</strong>. It is a fudge factor to account for all indirect light.</p>
</li>
</ul>
<p><img src="/images/Rendering/lighting-component-overview.png" alt="Fig1. lighting-component-overview(from[5])"></p>
<h3 id="The-Ambient-and-Emmisive-Components"><a href="#The-Ambient-and-Emmisive-Components" class="headerlink" title="The Ambient and Emmisive Components"></a>The Ambient and Emmisive Components</h3><p>To model light that is reflected more than one time before it enters the eye,we can use a very crude approximation known as “ambient light”. The ambient portion of the lighting equation depends only on the properties of materials and an ambient lighting value,which is often a global value used for the entire scene.<br>$$<br>c_{amb} = g_{amb} \cdot m_{amb}<br>\tag{1}<br>$$<br>The factor $m_{amb}$ is the material’s “ambient color”. This is almost always the same as the diffuse color (which is often defined using texture map). The other factor,$g_{amb}$,is the ambient light value.</p>
<p>Somtimes a ray of light travels directly from the light source to the eye,without striking any surface in between. The standard lighting equation accounts for such rays by assigning a material an <em>emissive</em> color. For example,when we render the surface of the light bulb,this surface will probably appear very bright,even if there’s no other light in the scene,because the light bulb is emitting light.</p>
<p>In many situations,the emissive contribution doesn’t depend on environmental factor; it is simply the emissive color of the material.<br>$$<br>c_{emis} = m_{emis}<br>\tag{2}<br>$$</p>
<h3 id="The-Diffuse-Component"><a href="#The-Diffuse-Component" class="headerlink" title="The Diffuse Component"></a>The Diffuse Component</h3><p>For diffuse lighting, the location of the viewer is not relevant,since the reflections are scattered randomly, and no matter where we position the camera,it is equally likely that a ray will be sent our way.</p>
<p><img src="/images/Rendering/diffuse-component.png" alt="Fig2. diffuse-component(From[1]))"></p>
<p>But the direction if incidence <strong>l</strong>,which is dictated by the position of the light source relative to the surface, is important. Diffuse lighting obeys <strong>Lambert’s law</strong>: the intensity of the reflected light is proportional to the cosine of the angle between the surface normal and the rays of light.</p>
<p><img src="/images/Rendering/lambert-law.png" alt="Fig3. lambert-law(from[5])"></p>
<p>We calculate the diffuse component according to Lambert’s Law:<br>$$<br>c_{diff} = c_{light} \cdot m_{diff} \cdot max(0,n \cdot l)<br>\tag{3}<br>$$<br>as before, <strong>n</strong> is the surface normal and <strong>l</strong> is a unit vector that points towards the light source. The factor $m_{diff}$ is the material’s diffuse color, which is the value that most people think of when they think of the “color” of an object. The diffuse material color often comes from a texture map. The diffuse color of the light source is $c_{light}$.</p>
<p>On thing needs attention, that is the max(), because we need to prevent the dot result of normal and light negative, we use $max(0,n \cdot l)$, so the object won’t be lighted by the rays from it’s back.</p>
<h3 id="The-Specular-Component"><a href="#The-Specular-Component" class="headerlink" title="The Specular Component"></a>The Specular Component</h3><p>The specular component is what gives surfaces a “shiny” appearance. If you don’t understand what a specular is, think about the professional term in animes:</p>
<p><img src="/images/Rendering/specular-sister.png" alt="Fig4. specular-in-eyes)"></p>
<p>Now let’s see how the standard model calculates the specular contribution. For convenience,we assume that all of these vectors are unit vectors.<br><img src="/images/Rendering/specular-component.png" alt="Fig5. specular-component(from[1]))"></p>
<ul>
<li><p><strong>n</strong> is the local outward-pointing surface normal</p>
</li>
<li><p><strong>v</strong> points towards the viewer.</p>
</li>
<li><p><strong>l</strong> points towards the light source.</p>
</li>
<li><p><strong>r</strong> is the <em>reflection</em> vector, which is the direction of a “perfect mirror bounce.” It’s the result of reflecting <strong>l</strong> about <strong>n</strong>.</p>
</li>
<li><p><strong>$\theta$</strong> is the angle between <strong>r</strong> and <strong>v</strong>.</p>
</li>
</ul>
<p>Of the four vectors, you can see the reflection vector can be computed by</p>
<p><img src="/images/Rendering/reflection-vector.png" alt="Fig6. reflection-vector(from[1]))"></p>
<p>The <strong>Phong Model</strong> for specular reflection is :<br>$$<br>c_{spec} = c_{light} \cdot m_{spec} \cdot max(0,v \cdot r)^{m_{gls}}<br>\tag{4}<br>$$<br>$$<br>r = 2(n \cdot l)n-l<br>$$</p>
<p>$m_{gls}$ means the glossiness of the material,also known as the <em>Phong exponent, specular exponent</em>, or just as the material <em>shininess</em>. This controls how wide the “hotspot” is - a smaller $m_{gls}$ produces a larger, more gradual falloff from the hotspot,and a larger $m_{gls}$ produces a tight hotspot with sharp falloff. $m_{spec}$ is related to “shininess”, it represents the material’s <em>specular color</em>. While $m_{gls}$ controls the size of the hotspot, $m_{spec}$ controls its intensity and color. $c_{light}$ is essentially the “color” of the light, which contains both its color and intensity.</p>
<p>But!!We usually use <strong>Blinn Phong Model</strong> instead of <strong>Phong Model</strong>.</p>
<p><img src="/images/Rendering/blinn-phong-model.png" alt="Fig7. blinn-phong-model(from[1])"></p>
<p>The Blinn phong model can be faster to implement in hardware than the Phong model, if the viewer and light source are far enough away from the object to be considered a constant,since then <strong>h</strong> is a constant and only needs to be computed once. But when <strong>v</strong> or <strong>l</strong> may not be considered constant, the Phong model calculation might be faster.<br>The <strong>Blinn Phong Model</strong> for specualr reflection is :<br>$$<br>c_{spec} = c_{light} \cdot m_{spec} \cdot max(0,n \cdot h)^{m_{gls}}<br>\tag{4}<br>$$<br>$$<br>h = \frac{v + l}{|v + l|}<br>$$</p>
<blockquote>
<p><strong>In real coding, vector in the above (1)(2)(3)(4) should be unit vector</strong></p>
</blockquote>
<h3 id="Limitations-of-the-Standard-Model"><a href="#Limitations-of-the-Standard-Model" class="headerlink" title="Limitations of the Standard Model"></a>Limitations of the Standard Model</h3><p>Why learn about this ancient history? First, it isn’t exactly ancient history, it’s alive and well. Second,the current local lighting model is one that content creators can understand and use. A final reason to learn the standard lighting model is because<br>many newer models bear similarities to the standard model, and you cannot<br>know when to use more advanced lighting models without understanding<br>the old standard.</p>
<p><img src="/images/Rendering/all-lighting-equation.png" alt="Fig8. all-lighting-equation(from[1])"></p>
<p>Since Blinn Phong Model contains all the components above,so we call the it Blinn-Phong. Actually, there are several important physical phenomena not properly  captured by the Blinn-Phong model. Such as <em>Fresnel reflectance</em>. (:) We’ll discuss this <strong>PBS</strong> part in the <strong>Appendix</strong>).</p>
<h3 id="Flat-amp-Gouraud-Shading"><a href="#Flat-amp-Gouraud-Shading" class="headerlink" title="Flat &amp; Gouraud Shading"></a>Flat &amp; Gouraud Shading</h3><p>This part is about the Shading Frequencies. Are you confused? If not, it’s impossible. Because I’m confused at the first time learning and the second time learning. But now, I got it. So come with me.</p>
<p>On modern shader-based hardware, lighting calculations are usually done on a per-pixel basis. By this we mean that for each pixel, we determine a surface normal (whether by interpolating the vertex normal across the face or by fetching it from a bump map), and then we perform the full lighting equation using this surface normal. This is per-pixel lighting, and the technique of interpolating vertex normals across the face is sometimes called <strong>Phong shading</strong>, not to be confused with the Phong calculation for specular reflection. The alternative to Phong shading is to perform the lighting equation less frequently (per face, or per vertex). These two techniques are known as <strong>flat shading</strong> and <strong>Gouraud shading</strong>, respectively. Flat shading is almost never used in practice except in software rendering. This is because most modern methods of sending geometry efficiently to the hardware do not provide any face-level data whatsoever. Gouraud shading, in contrast, still has some limited use on some platforms. Some important general principles can be gleaned from studying these methods, so let’s examine their results.</p>
<blockquote>
<p><strong>Phong shading ≠ Phong Reflection Model ≠ Blinn Phong Reflection Model</strong></p>
</blockquote>
<p><img src="/images/Rendering/shading-frequency.png" alt="Fig9. shading-frequency(from[5])"></p>
<p>The table below can list differences among them.</p>
<table>
<thead>
<tr>
<th align="center">per-pixel lighting</th>
<th align="center">per-vertex lighting</th>
<th align="center">per-face lighting</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Phong shading</td>
<td align="center">Gouraud shading</td>
<td align="center">Flat shading</td>
</tr>
<tr>
<td align="center">Interpolate normal vectors across each triangle</td>
<td align="center">Interpolate colors from vertices across triangle</td>
<td align="center">Triangle face is flat — one normal vector</td>
</tr>
<tr>
<td align="center">Compute full shading model at each pixel</td>
<td align="center">Each vertex has a normal vector</td>
<td align="center">Not good for smooth surfaces</td>
</tr>
<tr>
<td align="center"><img src="/images/Rendering/per-pixel-normal-vectors.png" alt="per-pixel-normal-vectors"></td>
<td align="center"><img src="/images/Rendering/per-vertex-normals.png" alt="per-vertex-normals"></td>
<td align="center">#</td>
</tr>
<tr>
<td align="center"><img src="/images/Rendering/phong-shaded.png" alt="phong-shaded"></td>
<td align="center"><img src="/images/Rendering/gouraud-shaded.png" alt="gouraud-shaded"></td>
<td align="center"><img src="/images/Rendering/flat-shaded.png" alt="flat-shaded"></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>Mostly used is phong shading</strong></p>
</blockquote>
<p>Talk is cheap, show me the code. Here’s a code (from[3])</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//per-pixel lighting</span></span><br><span class="line">Shader <span class="string">"Unity Shaders Book/Chapter 6/Blinn-Phong Use Built-in Functions"</span> &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _Diffuse (<span class="string">"Diffuse"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _Specular (<span class="string">"Specular"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _Gloss (<span class="string">"Gloss"</span>, Range(<span class="number">1.0</span>, <span class="number">500</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Pass &#123;</span><br><span class="line">            Tags &#123; <span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span> &#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line"></span><br><span class="line">            #include <span class="string">"Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">            fixed4 _Diffuse;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            <span class="keyword">float</span> _Gloss;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float3 normal : NORMAL;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span> &#123;</span></span><br><span class="line">                float4 pos : SV_POSITION;</span><br><span class="line">                float3 worldNormal : TEXCOORD0;</span><br><span class="line">                float4 worldPos : TEXCOORD1;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span> </span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Use the build-in funtion to compute the normal in world space</span></span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line"></span><br><span class="line">                o.worldPos = mul(unity_ObjectToWorld, v.vertex);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span><span class="params">(v2f i)</span> : SV_Target </span>&#123;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz;</span><br><span class="line"></span><br><span class="line">                fixed3 worldNormal = normalize(i.worldNormal);</span><br><span class="line">                <span class="comment">//  Use the build-in funtion to compute the light direction in world space</span></span><br><span class="line">                <span class="comment">// Remember to normalize the result</span></span><br><span class="line">                fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos));</span><br><span class="line"></span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * _Diffuse.rgb * <span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, worldLightDir));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Use the build-in funtion to compute the view direction in world space</span></span><br><span class="line">                <span class="comment">// Remember to normalize the result</span></span><br><span class="line">                fixed3 viewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br><span class="line"></span><br><span class="line">                fixed3 halfDir = normalize(worldLightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, halfDir)), _Gloss);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> fixed4(ambient + diffuse + specular, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack <span class="string">"Specular"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The result is :</p>
<p><img src="/images/Rendering/phong-shading.png" alt="Fig9. phong-shading(from[5])"></p>
<h2 id="Light-Sources"><a href="#Light-Sources" class="headerlink" title="Light Sources"></a>Light Sources</h2><p>If you have used <strong><em>Unity</em></strong>, you won’t forget different kinds of lights.</p>
<p><img src="/images/Rendering/unity-lights.png" alt="Fig10. unity-lights"></p>
<h3 id="Standard-Abstract-Light-Types"><a href="#Standard-Abstract-Light-Types" class="headerlink" title="Standard Abstract Light Types"></a>Standard Abstract Light Types</h3><ul>
<li><strong>A point light</strong> source represents light that emanates from a single point outward in all directions. Point lights are also called omni lights (short for “omnidirectional”) or spherical lights.A point light has a position and color, which controls not only the hue of the light, but also its intensity. Point lights can be used to represent many common light sources, such as light bulbs, lamps, fires, and so forth.</li>
</ul>
<blockquote>
<p><strong>point light = omni light = spherical light</strong></p>
</blockquote>
<p><img src="/images/Rendering/spot-light.png" alt="Fig10. spot-light(from[1])"></p>
<ul>
<li><strong>A spot light</strong> is used to represent light from a specific location in a specific direction. These are used for lights such as flashlights, headlights, and of course, spot lights~ As for <strong>A conical spot light</strong>, it has a circular “bottom”, the width of the cone is defined by a falloff angle(not to be confused with the falloff distance). Also, there is an inner angle that measures the size of the hotspot.</li>
</ul>
<p><img src="/images/conical-spot-light.png" alt="Fig11. conical-spot-light(from[1])"></p>
<ul>
<li><strong>A directional light</strong> represents light emanating from a point in space sufficiently far away that all the rays of light involved in lighting the scene (or at least the object we are currently considering) can be considered as <strong>parallel</strong>. Directional lights usually do not have a position, at least as far as lighting calculations are concerned, and they usually do not attenuate. Like the sun and moon in our real world.</li>
</ul>
<blockquote>
<p><strong>Directional light = parallel light = distant light</strong></p>
</blockquote>
<p><img src="/images/directional-light.png" alt="Fig12. directional-light(from[4])"></p>
<ul>
<li><strong>An area light</strong> is only useful in bake. So we don’t talke about it here.</li>
</ul>
<p>Here’s intuitional effects among the lights.</p>
<p><img src="/images/light-effects.png" alt="Fig13. light-effects(from[4])"></p>
<h3 id="Light-Attenuation"><a href="#Light-Attenuation" class="headerlink" title="Light Attenuation"></a>Light Attenuation</h3><p><strong>In the real world</strong>, the intensity of a light is inversely proportional to the square of the distance between the light and the object, as<br>$$<br>\frac{i_1}{i_2} = (\frac{d_2}{d_1})^2<br>\tag{1}<br>$$<br>where i is the radiant flux (the radiant power per unit area) and d is the distance. This part will be mentioned again in the <strong>RayTracing</strong> article, it’s about <strong>Radiometry</strong>. Here you just need to know that the final amount of emitted light is obtained by multiplying the light color by its intensity:</p>
<blockquote>
<p><strong>light amount = light color * light intensity</strong></p>
</blockquote>
<p><img src="/images/light-falloff.png" alt="Fig14. light-falloff(from[5])"></p>
<p>Actually,I haven’t used light-falloff in my coding. Also this blog is for the novices, so let’s continue with a simple practice and finish this part. Just rememeber that this is the very primary part.</p>
<p>Talk is cheap, show me the code.(frome[3])</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"Unity Shaders Book/Chapter 9/Forward Rendering"</span> &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line"></span><br><span class="line">        _Diffuse (<span class="string">"Diffuse"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _Specular (<span class="string">"Specular"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _Gloss (<span class="string">"Gloss"</span>, Range(<span class="number">8.0</span>, <span class="number">256</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Tags &#123; <span class="string">"RenderType"</span>=<span class="string">"Opaque"</span> &#125;</span><br><span class="line"></span><br><span class="line">        Pass &#123;</span><br><span class="line">            <span class="comment">// Pass for ambient light &amp; first pixel light (directional light)</span></span><br><span class="line">            Tags &#123; <span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span> &#125;</span><br><span class="line"></span><br><span class="line">            CGPROGRAM</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Apparently need to add this declaration </span></span><br><span class="line">            <span class="comment">//该指令可以保证我们的shader中使用的光照衰减等光照变量可以被正确赋值</span></span><br><span class="line">            #pragma multi_compile_fwdbase	</span><br><span class="line"></span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line"></span><br><span class="line">            #include <span class="string">"Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">            fixed4 _Diffuse;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            <span class="keyword">float</span> _Gloss;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float3 normal : NORMAL;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span> &#123;</span></span><br><span class="line">                float4 pos : SV_POSITION;</span><br><span class="line">                float3 worldNormal : TEXCOORD0;</span><br><span class="line">                float3 worldPos : TEXCOORD1;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span> </span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line"></span><br><span class="line">                o.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span><span class="params">(v2f i)</span> : SV_Target </span>&#123;</span><br><span class="line"></span><br><span class="line">                fixed3 worldNormal = normalize(i.worldNormal);</span><br><span class="line">                fixed3 worldLightDir = normalize(_WorldSpaceLightPos0.xyz);</span><br><span class="line"></span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz;</span><br><span class="line"></span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * _Diffuse.rgb * <span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, worldLightDir));</span><br><span class="line"></span><br><span class="line">                fixed3 viewDir = normalize(_WorldSpaceCameraPos.xyz - i.worldPos.xyz);</span><br><span class="line">                fixed3 halfDir = normalize(worldLightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, halfDir)), _Gloss);</span><br><span class="line"></span><br><span class="line">                fixed atten = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> fixed4(ambient + (diffuse + specular) * atten, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Pass &#123;</span><br><span class="line">            <span class="comment">// Pass for other pixel lights</span></span><br><span class="line">            Tags &#123; <span class="string">"LightMode"</span>=<span class="string">"ForwardAdd"</span> &#125;</span><br><span class="line"></span><br><span class="line">            Blend One One</span><br><span class="line"></span><br><span class="line">            CGPROGRAM</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Apparently need to add this declaration</span></span><br><span class="line">            <span class="comment">//该指令保证我们在additional pass 中访问到正确的光照变量</span></span><br><span class="line">            #pragma multi_compile_fwdadd</span><br><span class="line"></span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line"></span><br><span class="line">            #include <span class="string">"Lighting.cginc"</span></span><br><span class="line">            #include <span class="string">"AutoLight.cginc"</span></span><br><span class="line"></span><br><span class="line">            fixed4 _Diffuse;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            <span class="keyword">float</span> _Gloss;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float3 normal : NORMAL;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span> &#123;</span></span><br><span class="line">                float4 pos : SV_POSITION;</span><br><span class="line">                float3 worldNormal : TEXCOORD0;</span><br><span class="line">                float3 worldPos : TEXCOORD1;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span> </span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line"></span><br><span class="line">                o.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span><span class="params">(v2f i)</span> : SV_Target </span>&#123;</span><br><span class="line"></span><br><span class="line">                fixed3 worldNormal = normalize(i.worldNormal);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果当前处理的光源类型是平行光,因为平行光没有固定的位置</span></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">ifdef</span> USING_DIRECTIONAL_LIGHT</span></span><br><span class="line">                    fixed3 worldLightDir = normalize(_WorldSpaceLightPos0.xyz);</span><br><span class="line">                <span class="comment">//如果是点光源或者聚光灯，他们的位置是</span></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">                    fixed3 worldLightDir = normalize(_WorldSpaceLightPos0.xyz - i.worldPos.xyz);</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * _Diffuse.rgb * <span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, worldLightDir));</span><br><span class="line"></span><br><span class="line">                fixed3 viewDir = normalize(_WorldSpaceCameraPos.xyz - i.worldPos.xyz);</span><br><span class="line">                fixed3 halfDir = normalize(worldLightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="number">0</span>, dot(worldNormal, halfDir)), _Gloss);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果是平行光，衰减值为1</span></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">ifdef</span> USING_DIRECTIONAL_LIGHT</span></span><br><span class="line">                    fixed atten = <span class="number">1.0</span>;</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">                <span class="comment">//if point light,transform the vertex position from world spact to light space</span></span><br><span class="line">                <span class="comment">//sample the texture to get the Attenuation value</span></span><br><span class="line">                <span class="comment">//如果是点光源，把顶点坐标从世界空间到光线空间</span></span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">if</span> defined (POINT)</span></span><br><span class="line">                        float3 lightCoord = mul(unity_WorldToLight, float4(i.worldPos, <span class="number">1</span>)).xyz;</span><br><span class="line">                        fixed atten = tex2D(_LightTexture0, dot(lightCoord, lightCoord).rr).UNITY_ATTEN_CHANNEL;</span><br><span class="line">                    <span class="comment">//if spot light</span></span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">elif</span> defined (SPOT)</span></span><br><span class="line">                        float4 lightCoord = mul(unity_WorldToLight, float4(i.worldPos, <span class="number">1</span>));</span><br><span class="line">                        fixed atten = (lightCoord.z &gt; <span class="number">0</span>) * tex2D(_LightTexture0, lightCoord.xy / lightCoord.w + <span class="number">0.5</span>).w * tex2D(_LightTextureB0, dot(lightCoord, lightCoord).rr).UNITY_ATTEN_CHANNEL;</span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">                        fixed atten = <span class="number">1.0</span>;</span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> fixed4((diffuse + specular) * atten, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack <span class="string">"Specular"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If you want to know the rendering order,you can use the <strong><em>Frame Debug</em></strong>, this tool is really useful. I think as the study goes further, this part will be mentioned again. Also this is my learning curve, maybe it matches you too. So go on with my articles.</p>
<h2 id="Texture-Mapping"><a href="#Texture-Mapping" class="headerlink" title="Texture Mapping"></a>Texture Mapping</h2><p>Finally, here comes the texture mapping!I am already gearing up and eager to try. Cuz I really want to overview the shadow mapping and opacity blend again. And there are too many things cannot learn forward without the knowledge of texture.</p>
<h3 id="What-is-a-Texture"><a href="#What-is-a-Texture" class="headerlink" title="What is a Texture?"></a>What is a Texture?</h3><p>There is much more to the appearance of an object than its shape. Different objects are different colors and have different patterns on their surface. One simple yet powerful way to capture these qualities is through texture mapping. A texture map is a <strong><em>bitmap image</em></strong> that is “pasted” to the surface of an object.</p>
<p><img src="/images/texture.png" alt="Fig15. texture(from[5])"></p>
<blockquote>
<p><strong>bitmap image is pixel-image, on the contrary, vector-image</strong></p>
</blockquote>
<p>So a texture map is just a regular bitmap that is applied onto the surface of a model. Exactly how does this work? The key idea is that, at each point on the surface of the mesh, we can obtain texture-mapping coordinates, which define the 2D location in the texture map that corresponds to this 3D location. Traditionally, these coordinates are assigned the variables (u,v), where u is the horizontal coordinate and v is the vertical coordinate; thus texture-mapping coordinates are often called <strong>UV coordinates</strong> or <strong>simply UVs</strong>.</p>
<blockquote>
<p><strong>On thing needs attention : The origin is in the upper left-hand corner of the image, which is the DirectX-style convention, or in the lower left-hand corner, the OpenGL conventions.In unity, the powerful engine has solved the problem for us, unity use uniform left-hand corner as OpenGL.</strong></p>
</blockquote>
<p><img src="/images/uv-coordinates-in-unity.png" alt="Fig16. uv-coordinates-in-unity(from[3])"></p>
<p>Although bitmaps come in different sizes, UV coordinates are normalized such that the mapping space ranges from 0 to 1 over the entire width(u) or height (v) of the image, rather than depending on the image dimensions. We typically compute or assign UV coordinates only at the <strong><em>vertex</em></strong> level, and the UV coordinates at an arbitratry interior position on a face are obtained through <strong>interpolation</strong> (:) See in <strong>Appendix</strong>)</p>
<p>So the pseudo-code of UV mapping should be:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c++</span></span><br><span class="line"><span class="function"><span class="keyword">for</span> each rasterized screen <span class="title">sample</span> <span class="params">(x,y)</span>: <span class="comment">//sample (x,y)-usually a pixel's center</span></span></span><br><span class="line"><span class="function">    <span class="params">(u,v)</span> </span>= <span class="function">evaluate texture coordinate <span class="title">at</span> <span class="params">(x,y)</span> <span class="comment">//using barycentric coordinates</span></span></span><br><span class="line"><span class="function">    texcolor </span>= texture.sample(u,v);</span><br><span class="line">    <span class="built_in">set</span> sample’s color to texcolor; <span class="comment">//usually the diffuse albedo Kd(recall the Blinn-Phong reflectance model)</span></span><br></pre></td></tr></table></figure>

<h3 id="Texture-Magnification"><a href="#Texture-Magnification" class="headerlink" title="Texture Magnification"></a>Texture Magnification</h3><p>UV coordinates outside of the range [0,1] are allowed, and in fact are quite useful. Such coordinates are interpreted in a variety of ways. The most common addressing modes (<strong>Wrap Mode</strong>) are <strong>repeat</strong> (also known as tile or wrap) and <strong>clamp</strong>.</p>
<p>When repeating is used, the integer portion is discarded and only the fractional portion is used, causing the texture to repeat. Under clamping, when a coordinate outside the range [0,1] is used to access a bitmap, it is clamped in range. This has the effect of streaking the edge pixels of the bitmap outwards. The mesh in both cases is identical: a single polygon with four vertices. And the meshes have identical UV coordinates. The only difference is how coordinates outside the [0,1] range are interpreted. See Fig17.</p>
<p><img src="/images/uv-warp-mode.png" alt="Fig17. uv-warp-mode(from[1])"></p>
<p>If you have used Unity, this is not strange to you. See the example below(from[3]).</p>
<p><img src="/images/wrap-mode-example.png" alt="Fig17-1. wrap-mode-repeat(from[3])"><br><img src="/images/wrap-mode-example-1.png" alt="Fig17-2. wrap-mode-clamp(from[3])"></p>
<p>The shader code on the materail of the Quad is :</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"Unity Shaders Book/Chapter 7/Texture Properties"</span> &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _MainTex (<span class="string">"Main Tex"</span>, <span class="number">2</span>D) = <span class="string">"white"</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Pass &#123;</span><br><span class="line">            Tags &#123; <span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span> &#125;</span><br><span class="line"></span><br><span class="line">            CGPROGRAM</span><br><span class="line"></span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line"></span><br><span class="line">            #include <span class="string">"Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float4 texcoord : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span> &#123;</span></span><br><span class="line">                float4 <span class="built_in">position</span> : SV_POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span> </span>&#123;</span><br><span class="line">                 v2f o;</span><br><span class="line"></span><br><span class="line">                 <span class="comment">// Transform the vertex from object space to projection space</span></span><br><span class="line">                 o.<span class="built_in">position</span> = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//注意这里的v是模型空间中就定义好的纹理坐标</span></span><br><span class="line">                <span class="comment">//v.texcoord应该是0-1之间,如果在面板上更改缩放值和偏移量，就会改动o.uv不在0-1之间</span></span><br><span class="line">                <span class="comment">//o.uv = v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw;</span></span><br><span class="line">                 o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);</span><br><span class="line"></span><br><span class="line">                 <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span><span class="params">(v2f i)</span> : SV_Target </span>&#123;</span><br><span class="line">                <span class="comment">//根据uv值对纹理进行采样</span></span><br><span class="line">                fixed4 c = tex2D(_MainTex, i.uv);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> fixed4(c.rgb, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack <span class="string">"Diffuse"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I think you have noticed the code //o.uv = v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw; Look at the gif below, <strong><em>_MainTex_ST.xy</em></strong> means <strong><em>Tiling</em></strong>, <strong><em>_MainTex_ST.zw</em></strong> means <strong><em>offset</em></strong>.</p>
<p><img src="/images/tilling-offset.gif" alt="Fig18. tilling-offset"></p>
<p>Also, I think you have noticed that there is <strong>Mipmap</strong> &amp; <strong>FilterMode</strong> properties in the panel of Fig17-1, what’s the meaning of these? You see that in Unity, the png is 512*512, it matches the Quad just in time. <strong><em>What if the texture(png) is too small?</em></strong> It’s easy to imagine, that you have an image, but the object is too giant, you need some methods to let the texture ‘pasted’ on the object surface without low resolution/distortion.</p>
<p><img src="/images/filter-mode.png" alt="Fig19. filter-mode(from[5])"></p>
<p>Here I want to infer <strong>Bilinear Interpolation</strong> (:) see it in the <strong>Appendix</strong>)</p>
<p><strong><em>Then What if the texture(png) is too large?</em></strong> Here comes Mipmap (This part is a little hard for me. so Jump over it and later back..)</p>
<h3 id="Different-Types-Texture-Mapping"><a href="#Different-Types-Texture-Mapping" class="headerlink" title="Different Types Texture Mapping"></a>Different Types Texture Mapping</h3><p>There are too many types of texture mapping.</p>
<h4 id="Bump-Mapping"><a href="#Bump-Mapping" class="headerlink" title="Bump Mapping"></a>Bump Mapping</h4><p>Bump mapping is a general term that can refer to at least <strong>two different methods</strong> of controlling the surface normal per texel.</p>
<ul>
<li><p><strong>A height map</strong> is a grayscale map, in which the intensity indicates the local “elevation” of the surface. Lighter colors indicate portions of the surface that are “bumped out,” and darker colors are areas where the surface is “bumped in.” Height maps are attractive because they are very easy to author, but they are not ideal for real-time purposes because the normal is not directly available; instead, it must be calculated from the intensity gradient. (We wil talk about it in <strong>Displacement Mapping</strong>)</p>
</li>
<li><p><strong>A bump map</strong>, which is very common nowadays, is <strong>Normal Mapping</strong>.</p>
</li>
</ul>
<p><img src="/images/two-bumping-methods.png" alt="Fig20. two-bumping-methods(from[5])"></p>
<h5 id="Normal-Mapping"><a href="#Normal-Mapping" class="headerlink" title="Normal Mapping"></a>Normal Mapping</h5><p>In a normal map, the coordinates of the surface normal are directly encoded in the map. How could a bump map save the surface normal of the object? Of course, the color. The most basic way is to encode x, y, and z in the red, green, and blue channels. Since the normal vector is bounded in [-1,1],and the color channel component is bounded in [0,1], so there should be a principle:<br>$$<br>pixel = \frac{normal + 1}{2}<br>$$<br>Seems easy~ The bump map storse the normal vectors in model space in terms of pixels(rgb). Voila! If only it were that easy.</p>
<p>Real-world objects exhibit a great deal of symmetry and self-similarity, and patterns are often repeated. For example, a box often has similar bumps and notches on more than one side. Because of this, it is currently a more efficient use of the same amount of memory (and artist time) to increase the resolution of the map and reuse the same normal map (or perhaps just portions of it) on multiple models (or perhaps just on multiple places in the same model). Of course, the same principle applies to any sort of texture map, not just normal maps. <em>But normal maps are different in that they cannot be arbitrarily rotated or mirrored because they encode a vector.</em> Imagine using the same normal map on all six sides of a cube. While shading a point on the surface of the cube, we will fetch a texel from the map and decode it into a 3D vector. A particular normal map texel on the top will produce a surface normal that points in the same direction as that same texel on the bottom of the cube, when they should be opposites! We need some other kind of information to tell us how to interpret the normal we get from the texture, and this extra bit of information is stored in the basis vectors.</p>
<p>So there comes the <strong>Tangent Space</strong>.<br>In tangent space, +z points out from the surface; the +z basis vector is actually just the surface normal n. The x basis vector is known as the tangent vector, which we’ll denote t, and it points in the direction of increasing t in texture space. Similarly, the y basis vector, known as the binormal and denoted here as b, corresponds to the direction of increasing b, although whether this motion is “up” or “down” in the texture space depends on the conventions for the origin in (t,b) space, which can differ, as we discussed earlier. The coordinates for the tangent and binormal are given in model space.</p>
<p><img src="/images/tangent-space.png" alt="Fig21. tangent-space(from[3])"></p>
<p>And how to calculate basis vectors as the average of adjacent triangle normals?Here’s the formula &amp; code(from[1])<br>We are given a triangle with vertex positions $p_0 = (x_0 ,y_0 ,z_0 ), p_1 = (x_1 ,y_1 ,z_1 ), and p_2 = (x_2 ,y_2 ,z_2),$ and at those vertices we have the UV coordinates $(u_0 ,v_0 ), (u_1 ,v_1 ), and (u_2 ,v_2 ).$<br>$$<br>q_1 = p_1 − p_0 , s_1 = u_1 − u_0 , t_1 = v_1 − v_0<br>$$<br>$$<br>q_2 = p 2 − p_0 , s_2 = u_2 − u_0 , t_2 = v_2 − v_0.<br>$$<br>$$<br>tangent = t_2q_1 - t_1q_2 , binormal = -s_2q_1 + s_1q_2<br>$$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c++</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Vertex</span> &#123;</span></span><br><span class="line">    Vector3 pos ;</span><br><span class="line">    <span class="keyword">float</span> u, v ;</span><br><span class="line">    Vector3 normal ;</span><br><span class="line">    Vector3 tangent ;</span><br><span class="line">    <span class="keyword">float</span> det ; <span class="comment">// determinant of tangent transform. (−1 i f mirrored )</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Triangle</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> vertexIndex [<span class="number">3</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TriangleMesh</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> vertexCount ;</span><br><span class="line">    Vertex ∗vertexList ;</span><br><span class="line">    <span class="keyword">int</span> triangleCount ;</span><br><span class="line">    Triangle ∗ triangleList ;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">computeBasisVectors</span> <span class="params">( )</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Note: we assume vertex normals are valid</span></span><br><span class="line">        Vector3 ∗tempTangent = <span class="keyword">new</span> Vector3 [ vertexCount ];</span><br><span class="line">        Vector3 ∗tempBinormal = <span class="keyword">new</span> Vector3 [ vertexCount ];</span><br><span class="line">        <span class="comment">// F i r s t clear out the accumulators</span></span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; vertexCount ; ++i ) &#123;</span><br><span class="line">            tempTangent [i].zero ( ) ;</span><br><span class="line">            tempBinormal [i].zero ( ) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Average in the basis vectors for each face</span></span><br><span class="line">        <span class="comment">// into i t s neighboring vertices</span></span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; triangleCount ; ++i ) &#123;</span><br><span class="line">            <span class="comment">// Get shortcuts</span></span><br><span class="line">            <span class="keyword">const</span> Triangle &amp;tri = triangleList [ i ];</span><br><span class="line">            <span class="keyword">const</span> Vertex &amp;v0 = vertexList [ tri.vertexIndex [<span class="number">0</span>]];</span><br><span class="line">            <span class="keyword">const</span> Vertex &amp;v1 = vertexList [ tri.vertexIndex [<span class="number">1</span>]];</span><br><span class="line">            <span class="keyword">const</span> Vertex &amp;v2 = vertexList [ tri.vertexIndex [<span class="number">2</span>]];</span><br><span class="line">            <span class="comment">// Compute intermediate values</span></span><br><span class="line">            Vector3 q1 = v1.pos − v0.pos ;</span><br><span class="line">            Vector3 q2 = v2.pos − v0.pos ;</span><br><span class="line">            <span class="keyword">float</span> s1 = v1.u − v0.u;</span><br><span class="line">            <span class="keyword">float</span> s2 = v2.u − v0.u;</span><br><span class="line">            <span class="keyword">float</span> t1 = v1.v − v0.v ;</span><br><span class="line">            <span class="keyword">float</span> t2 = v2.v − v0.v ;</span><br><span class="line">            <span class="comment">// Compute basis vectors for this triangle</span></span><br><span class="line">            Vector3 tangent = t2∗q1 − t1∗q2; tangent.normalize ( ) ;</span><br><span class="line">            Vector3 binormal = −s2∗q1 + s1∗q2; binormal.normalize ( ) ;</span><br><span class="line">            <span class="comment">// Add them into the running totals for neighboring verts</span></span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++j ) &#123;</span><br><span class="line">            tempTangent [ tri.vertexIndex [ j ]] += tangent ;</span><br><span class="line">            tempBinormal [ tri.vertexIndex [ j ]] += binormal ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Now f i l l in the values into the vertices</span></span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; vertexCount ; ++i ) &#123;</span><br><span class="line">            Vertex &amp;v = vertexList [ i ];</span><br><span class="line">            Vector3 t = tempTangent [ i ];</span><br><span class="line">            <span class="comment">// Ensure tangent is perpendicular to the normal.</span></span><br><span class="line">            <span class="comment">// (Gram−Schmit ) , then keep normalized version</span></span><br><span class="line">            t −= v.normal ∗ dot (t,v.normal ) ;</span><br><span class="line">            t.normalize ( ) ;</span><br><span class="line">            v.tangent = t ;</span><br><span class="line">            <span class="comment">// Figure out i f we’ re mirrored</span></span><br><span class="line">            <span class="keyword">if</span> ( dot ( cross ( v.normal , t ) , tempBinormal [ i ]) &lt; <span class="number">0.0</span> f ) &#123;</span><br><span class="line">            v.det = −<span class="number">1.0f</span> ; <span class="comment">// we’ re mirrored</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            v.det = +<span class="number">1.0</span> f ; <span class="comment">// not mirrored</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Clean up</span></span><br><span class="line">        <span class="keyword">delete</span> [] tempTangent ;</span><br><span class="line">        <span class="keyword">delete</span> [] tempBinormal ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>In unity, you can calculate the lighting model in the world space with bump textures.Here an example.(from[3])</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"Unity Shaders Book/Chapter 7/Normal Map In World Space"</span> &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _Color (<span class="string">"Color Tint"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _MainTex (<span class="string">"Main Tex"</span>, <span class="number">2</span>D) = <span class="string">"white"</span> &#123;&#125;</span><br><span class="line">        _BumpMap (<span class="string">"Normal Map"</span>, <span class="number">2</span>D) = <span class="string">"bump"</span> &#123;&#125;</span><br><span class="line">        _BumpScale (<span class="string">"Bump Scale"</span>, Float) = <span class="number">1.0</span></span><br><span class="line">        _Specular (<span class="string">"Specular"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        _Gloss (<span class="string">"Gloss"</span>, Range(<span class="number">8.0</span>, <span class="number">256</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Pass &#123;</span><br><span class="line">            Tags &#123; <span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span> &#125;</span><br><span class="line"></span><br><span class="line">            CGPROGRAM</span><br><span class="line"></span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line"></span><br><span class="line">            #include <span class="string">"Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">            fixed4 _Color;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line">            sampler2D _BumpMap;</span><br><span class="line">            float4 _BumpMap_ST;</span><br><span class="line">            <span class="keyword">float</span> _BumpScale;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            <span class="keyword">float</span> _Gloss;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float3 normal : NORMAL;</span><br><span class="line">                float4 tangent : TANGENT;</span><br><span class="line">                float4 texcoord : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span> &#123;</span></span><br><span class="line">                float4 pos : SV_POSITION;</span><br><span class="line">                float4 uv : TEXCOORD0;</span><br><span class="line">                float4 TtoW0 : TEXCOORD1;  </span><br><span class="line">                float4 TtoW1 : TEXCOORD2;  </span><br><span class="line">                float4 TtoW2 : TEXCOORD3;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span> </span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">                o.uv.xy = v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw;</span><br><span class="line">                o.uv.zw = v.texcoord.xy * _BumpMap_ST.xy + _BumpMap_ST.zw;</span><br><span class="line"></span><br><span class="line">                float3 worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;  </span><br><span class="line">                fixed3 worldNormal = UnityObjectToWorldNormal(v.normal);  </span><br><span class="line">                fixed3 worldTangent = UnityObjectToWorldDir(v.tangent.xyz);  </span><br><span class="line">                fixed3 worldBinormal = cross(worldNormal, worldTangent) * v.tangent.w; </span><br><span class="line"></span><br><span class="line">                <span class="comment">// Compute the matrix that transform directions from tangent space to world space</span></span><br><span class="line">                <span class="comment">// Put the world position in w component for optimization</span></span><br><span class="line">                o.TtoW0 = float4(worldTangent.x, worldBinormal.x, worldNormal.x, worldPos.x);</span><br><span class="line">                o.TtoW1 = float4(worldTangent.y, worldBinormal.y, worldNormal.y, worldPos.y);</span><br><span class="line">                o.TtoW2 = float4(worldTangent.z, worldBinormal.z, worldNormal.z, worldPos.z);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span><span class="params">(v2f i)</span> : SV_Target </span>&#123;</span><br><span class="line">                <span class="comment">// Get the position in world space</span></span><br><span class="line">                float3 worldPos = float3(i.TtoW0.w, i.TtoW1.w, i.TtoW2.w);</span><br><span class="line">                <span class="comment">// Compute the light and view dir in world space</span></span><br><span class="line">                fixed3 lightDir = normalize(UnityWorldSpaceLightDir(worldPos));</span><br><span class="line">                fixed3 viewDir = normalize(UnityWorldSpaceViewDir(worldPos));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Get the normal in tangent space</span></span><br><span class="line">                fixed3 bump = UnpackNormal(tex2D(_BumpMap, i.uv.zw));</span><br><span class="line">                bump.xy *= _BumpScale;</span><br><span class="line">                bump.z = <span class="built_in">sqrt</span>(<span class="number">1.0</span> - saturate(dot(bump.xy, bump.xy)));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Transform the narmal from tangent space to world space</span></span><br><span class="line">                bump = normalize(half3(dot(i.TtoW0.xyz, bump), dot(i.TtoW1.xyz, bump), dot(i.TtoW2.xyz, bump)));</span><br><span class="line"></span><br><span class="line">                fixed3 albedo = tex2D(_MainTex, i.uv).rgb * _Color.rgb;</span><br><span class="line"></span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line"></span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * <span class="built_in">max</span>(<span class="number">0</span>, dot(bump, lightDir));</span><br><span class="line"></span><br><span class="line">                fixed3 halfDir = normalize(lightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="number">0</span>, dot(bump, halfDir)), _Gloss);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> fixed4(ambient + diffuse + specular, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack <span class="string">"Specular"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/unity-normal-map.png" alt="Fig22. unity-normal-map(from[3])"></p>
<h5 id="Displacement-Mapping"><a href="#Displacement-Mapping" class="headerlink" title="Displacement Mapping"></a>Displacement Mapping</h5><p>A height map (or true displacement map) can be easily painted in <em>Photoshop</em>; Since normal map is clear , displacement is not hard for you.<br>A displacement map actually changes the geometry using a texture. A common simplification is that the displacement will be in the direction of the surface normal.</p>
<p><img src="/images/displacement-map.png" alt="Fig23. displacement-map(from[2])"></p>
<p>$$<br>p\prime = p + f(p)n.<br>$$</p>
<h4 id="Environment-Mapping"><a href="#Environment-Mapping" class="headerlink" title="Environment Mapping"></a>Environment Mapping</h4><p>Often we want to have a texture-mapped background and for objects to have specular reflections of that background. This can be accomplished using <strong><em>environment maps</em></strong>; There are many ways to store environment maps. Here is the most common method <strong><em>cube map</em></strong>.</p>
<p>If you have used Unity, then you’ll be familiar with cube map, yes, the sky box~ In ideal cases, we want to generate the corresponding cube map for the objects of different positions in the scene. So the smart way is to write scripts. Here’s an example</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEditor;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RenderCubemapWizard</span> :</span> ScriptableWizard &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Transform renderFromPosition;</span><br><span class="line">    <span class="keyword">public</span> Cubemap cubemap;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnWizardUpdate</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        helpString = <span class="string">"Select transform to render from and cubemap to render into"</span>;</span><br><span class="line">        <span class="built_in">isValid</span> = (renderFromPosition != null) &amp;&amp; (cubemap != null);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnWizardCreate</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// create temporary camera for rendering</span></span><br><span class="line">        GameObject go = <span class="keyword">new</span> GameObject( <span class="string">"CubemapCamera"</span>);</span><br><span class="line">        go.AddComponent&lt;Camera&gt;();</span><br><span class="line">        <span class="comment">// place it on the object</span></span><br><span class="line">        go.transform.<span class="built_in">position</span> = renderFromPosition.<span class="built_in">position</span>;</span><br><span class="line">        <span class="comment">// render into cubemap</span></span><br><span class="line">        go.GetComponent&lt;Camera&gt;().RenderToCubemap(cubemap);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// destroy temporary camera</span></span><br><span class="line">        DestroyImmediate( go );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [MenuItem(<span class="string">"GameObject/Render into Cubemap"</span>)]</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RenderCubemap</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        ScriptableWizard.DisplayWizard&lt;RenderCubemapWizard&gt;(</span><br><span class="line">            <span class="string">"Render cubemap"</span>, <span class="string">"Render!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Shadow-Maps"><a href="#Shadow-Maps" class="headerlink" title="Shadow Maps"></a>Shadow Maps</h4><p>Here comes the shadow map.</p>
<h3 id="Opacity-Blending"><a href="#Opacity-Blending" class="headerlink" title="Opacity Blending"></a>Opacity Blending</h3><hr>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix:"></a>Appendix:</h1><h2 id="PBS"><a href="#PBS" class="headerlink" title="PBS"></a>PBS</h2><p>This part will be explained in <strong>First-Met-With-RayTracing</strong>.</p>
<h2 id="Interpolation"><a href="#Interpolation" class="headerlink" title="Interpolation"></a>Interpolation</h2><p>Before learning CG, I couldn’t understand the term <strong>interpolation</strong>. Now it’s time write something about it.<br>There are many interpolation methods, today I want to introduce a common method, called <strong>Barycentric Coordinates</strong> - used in Interpolation Across Triangles. If you have read the above the paragraphs carefully, you can see the barycentric coordinates method has appeared before.</p>
<h3 id="Why-do-we-want-interplate"><a href="#Why-do-we-want-interplate" class="headerlink" title="Why do we want interplate?"></a>Why do we want interplate?</h3><ul>
<li><p>Specify values at vertices</p>
</li>
<li><p>Obtain smoothly varying values across triangles</p>
</li>
</ul>
<h3 id="What-do-we-want-to-interpolate"><a href="#What-do-we-want-to-interpolate" class="headerlink" title="What do we want to interpolate?"></a>What do we want to interpolate?</h3><ul>
<li>Texture coordinates, colors, normal vectors, …</li>
</ul>
<h3 id="Barycentric-Coordinates-Formulas"><a href="#Barycentric-Coordinates-Formulas" class="headerlink" title="Barycentric Coordinates: Formulas"></a>Barycentric Coordinates: Formulas</h3><p><img src="/images/Barycentric-Coordinates.png" alt="Fig15. Barycentric-Coordinates(from[5])"></p>
<p>$$<br>\alpha = \frac{-(x-x_B)(y_C - y_B) + (y-y_B)(x_C-x_B)}{-(x_A-x_B)(y_C-y_B) + (y_A-y_B)(x_C-x_B)}<br>\tag{Barycentric Coordinates: Formulas}<br>$$<br>$$<br>\beta = \frac{-(x-x_C)(y_A-y_C) + (y-y_C)(x_A-x_C)}{-(x_B-x_C)(y_A-y_C) + (y_B-y_C)(x_A-x_C)}<br>$$<br>$$<br>\gamma = 1 - \alpha - \beta<br>$$</p>
<h3 id="Using-Barycentric-Coordinates"><a href="#Using-Barycentric-Coordinates" class="headerlink" title="Using Barycentric Coordinates"></a>Using Barycentric Coordinates</h3><p><img src="/images/using-barycentric.png" alt="Fig15. using-barycentrics(from[5])"></p>
<p>talk is cheap, show me the code</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c++</span></span><br><span class="line">static std::tuple&lt;float, float, float&gt; computeBarycentric2D(float x, float y, const Vector4f* v)&#123;</span><br><span class="line">    <span class="keyword">float</span> alpha = (x*(v[<span class="number">1</span>].y() - v[<span class="number">2</span>].y()) + (v[<span class="number">2</span>].x() - v[<span class="number">1</span>].x())*y + v[<span class="number">1</span>].x()*v[<span class="number">2</span>].y() - v[<span class="number">2</span>].x()*v[<span class="number">1</span>].y()) / (v[<span class="number">0</span>].x()*(v[<span class="number">1</span>].y() - v[<span class="number">2</span>].y()) + (v[<span class="number">2</span>].x() - v[<span class="number">1</span>].x())*v[<span class="number">0</span>].y() + v[<span class="number">1</span>].x()*v[<span class="number">2</span>].y() - v[<span class="number">2</span>].x()*v[<span class="number">1</span>].y());</span><br><span class="line">    <span class="keyword">float</span> beta = (x*(v[<span class="number">2</span>].y() - v[<span class="number">0</span>].y()) + (v[<span class="number">0</span>].x() - v[<span class="number">2</span>].x())*y + v[<span class="number">2</span>].x()*v[<span class="number">0</span>].y() - v[<span class="number">0</span>].x()*v[<span class="number">2</span>].y()) / (v[<span class="number">1</span>].x()*(v[<span class="number">2</span>].y() - v[<span class="number">0</span>].y()) + (v[<span class="number">0</span>].x() - v[<span class="number">2</span>].x())*v[<span class="number">1</span>].y() + v[<span class="number">2</span>].x()*v[<span class="number">0</span>].y() - v[<span class="number">0</span>].x()*v[<span class="number">2</span>].y());</span><br><span class="line">    <span class="keyword">float</span> gamma = (x*(v[<span class="number">0</span>].y() - v[<span class="number">1</span>].y()) + (v[<span class="number">1</span>].x() - v[<span class="number">0</span>].x())*y + v[<span class="number">0</span>].x()*v[<span class="number">1</span>].y() - v[<span class="number">1</span>].x()*v[<span class="number">0</span>].y()) / (v[<span class="number">2</span>].x()*(v[<span class="number">0</span>].y() - v[<span class="number">1</span>].y()) + (v[<span class="number">1</span>].x() - v[<span class="number">0</span>].x())*v[<span class="number">2</span>].y() + v[<span class="number">0</span>].x()*v[<span class="number">1</span>].y() - v[<span class="number">1</span>].x()*v[<span class="number">0</span>].y());</span><br><span class="line">    <span class="keyword">return</span> &#123;alpha,beta,gamma&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//we all know that color,vertex position,normal are Vector3f</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Eigen::Vector3f <span class="title">interpolate</span><span class="params">(<span class="keyword">float</span> alpha, <span class="keyword">float</span> beta, <span class="keyword">float</span> gamma, <span class="keyword">const</span> Eigen::Vector3f&amp; vert1, <span class="keyword">const</span> Eigen::Vector3f&amp; vert2, <span class="keyword">const</span> Eigen::Vector3f&amp; vert3, <span class="keyword">float</span> weight)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (alpha * vert1 + beta * vert2 + gamma * vert3) / weight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//uv coordinates are Vector2f</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Eigen::Vector2f <span class="title">interpolate</span><span class="params">(<span class="keyword">float</span> alpha, <span class="keyword">float</span> beta, <span class="keyword">float</span> gamma, <span class="keyword">const</span> Eigen::Vector2f&amp; vert1, <span class="keyword">const</span> Eigen::Vector2f&amp; vert2, <span class="keyword">const</span> Eigen::Vector2f&amp; vert3, <span class="keyword">float</span> weight)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> u = (alpha * vert1[<span class="number">0</span>] + beta * vert2[<span class="number">0</span>] + gamma * vert3[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">auto</span> v = (alpha * vert1[<span class="number">1</span>] + beta * vert2[<span class="number">1</span>] + gamma * vert3[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    u /= weight;</span><br><span class="line">    v /= weight;</span><br><span class="line">    <span class="keyword">return</span> Eigen::Vector2f(u, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//here's the rasterization process</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rasterization</span><span class="params">(Triangle &amp;t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   ...<span class="built_in">find</span> the bounding box of t</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x = <span class="keyword">int</span>(x_min); x &lt; <span class="keyword">int</span>(x_max)+<span class="number">1</span>; x++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="keyword">int</span>(y_min); y&lt; <span class="keyword">int</span>(y_max)+<span class="number">1</span>;y++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(insideTriangle(<span class="keyword">float</span>(x) + <span class="number">0.5</span>, <span class="keyword">float</span>(y) + <span class="number">0.5</span>, t))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//get alpha,beta,gamma</span></span><br><span class="line">                <span class="keyword">auto</span>[alpha, beta, gamma] = computeBarycentric2D(x, y, t.v);</span><br><span class="line">                <span class="keyword">float</span> Z = <span class="number">1.0</span> / (alpha / v[<span class="number">0</span>].w() + beta / v[<span class="number">1</span>].w() + gamma / v[<span class="number">2</span>].w());</span><br><span class="line">                <span class="comment">//interpolate depth</span></span><br><span class="line">                <span class="keyword">float</span> zp = alpha * v[<span class="number">0</span>].z() / v[<span class="number">0</span>].w() + beta * v[<span class="number">1</span>].z() / v[<span class="number">1</span>].w() + gamma * v[<span class="number">2</span>].z() / v[<span class="number">2</span>].w();</span><br><span class="line">                zp *= Z;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//if pass the depth test</span></span><br><span class="line">                    <span class="keyword">auto</span> interpolated_color = interpolate(alpha,beta,gamma,t.color[<span class="number">0</span>],t.color[<span class="number">1</span>],t.color[<span class="number">2</span>],<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">auto</span> interpolated_normal = interpolate(alpha,beta,gamma,t.normal[<span class="number">0</span>],t.normal[<span class="number">1</span>],t.normal[<span class="number">2</span>],<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">auto</span> interpolated_texcoords = interpolate(alpha,beta,gamma,t.tex_coords[<span class="number">0</span>],t.tex_coords[<span class="number">1</span>],t.tex_coords[<span class="number">2</span>],<span class="number">1</span>);</span><br><span class="line">                   ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Bilinear-Interpolation"><a href="#Bilinear-Interpolation" class="headerlink" title="Bilinear Interpolation"></a>Bilinear Interpolation</h3><p>Since we mentioned bilinear interpolation in the texture magnificient part. So let’s go straight.</p>
<p><img src="/images/bilinear-interpolation.png" alt="bilinear-interpolation(from[5])"></p>
<ul>
<li><strong>Step1.</strong> We want to sample texture f(x,y) at red point, black points indicate texture sample locations.</li>
<li><strong>Step2.</strong> Take 4 nearest sample locations, with texture values as labeled.</li>
<li><strong>Step3.</strong> Calculate fractional offsets,(s,t)</li>
<li><strong>Step4.</strong></li>
</ul>
<p>$$<br>lerp(x,v_0,v_1) = v_0 + x(v_1 - v_0)<br>\tag{Linear interpolation (1D)}<br>$$<br>$$<br>u_0 = lerp(s,u_{00},u_{10})<br>$$<br>$$<br>u_1 = lerp(s,u_{01},u_{11})<br>\tag{Two helper lerps}<br>$$<br>$$<br>f(x,y) = lerp(t,u_0,u_1)<br>\tag{Final vertical lerp, to get result}<br>$$</p>
<p>talk is cheap, show me the code</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c++/opencv</span></span><br><span class="line"><span class="function">Eigen::Vector3f <span class="title">getColor</span><span class="params">(<span class="keyword">float</span> u, <span class="keyword">float</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> u_img = u * (<span class="built_in">width</span><span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">auto</span> v_img = (<span class="number">1</span> - v) * (<span class="built_in">height</span><span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> color = image_data.at&lt;cv::Vec3b&gt;(v_img, u_img);</span><br><span class="line">        <span class="keyword">return</span> Eigen::Vector3f(color[<span class="number">0</span>], color[<span class="number">1</span>], color[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//if the texture image is low-pixels, then u_img &amp; v_img will not be int(ideally case).</span></span><br><span class="line">    <span class="function">Eigen::Vector3f <span class="title">getColorBilinear</span><span class="params">(<span class="keyword">float</span> u,<span class="keyword">float</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> u_img = u * (<span class="built_in">width</span><span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">auto</span> v_img = v * (<span class="built_in">height</span><span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function">Eigen::Vector2f <span class="title">u00</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">floor</span>(u_img)*<span class="number">1.f</span>,<span class="built_in">std</span>::<span class="built_in">floor</span>(v_img)*<span class="number">1.f</span>)</span></span>;</span><br><span class="line">        <span class="function">Eigen::Vector2f <span class="title">u10</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">ceil</span>(u_img)*<span class="number">1.f</span>,<span class="built_in">std</span>::<span class="built_in">floor</span>(v_img)*<span class="number">1.f</span>)</span></span>;</span><br><span class="line">        <span class="function">Eigen::Vector2f <span class="title">u01</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">floor</span>(u_img)*<span class="number">1.f</span>,<span class="built_in">std</span>::<span class="built_in">ceil</span>(v_img)*<span class="number">1.f</span>)</span></span>;</span><br><span class="line">        <span class="function">Eigen::Vector2f <span class="title">u11</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">ceil</span>(u_img)*<span class="number">1.f</span>,<span class="built_in">std</span>::<span class="built_in">ceil</span>(v_img)*<span class="number">1.f</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> s = (u_img - u00.x());</span><br><span class="line">        <span class="keyword">float</span> t = (v_img - u00.y());</span><br><span class="line"></span><br><span class="line">        Eigen::Vector3f u0 = lerp(s,getColor(u00.x()/<span class="built_in">width</span>,u00.y()/<span class="built_in">height</span>),getColor(u10.x()/<span class="built_in">width</span>,u10.y()/<span class="built_in">height</span>));</span><br><span class="line">        Eigen::Vector3f u1 = lerp(s,getColor(u01.x()/<span class="built_in">width</span>,u01.y()/<span class="built_in">height</span>),getColor(u11.x()/<span class="built_in">width</span>,u11.y()/<span class="built_in">height</span>));</span><br><span class="line"></span><br><span class="line">        Eigen::Vector3f color = lerp(t,u0,u1);</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Eigen::Vector3f <span class="title">lerp</span><span class="params">(<span class="keyword">float</span> coefficient,Eigen::Vector3f a,Eigen::Vector3f b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//return (coefficient * a + (1-coefficient) * b);</span></span><br><span class="line">        <span class="keyword">return</span> (a + coefficient*(b-a));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>For the code above, I have a few words to add:</p>
<blockquote>
<p><strong>In opencv:</strong><br><strong>Mat image;</strong><br><strong>image.at&lt;&gt;(i,j)   i–&gt;y j–&gt;x</strong><br><strong>color order : BGR</strong><br><strong>the origin is at the upper-left corner</strong></p>
</blockquote>
<p><strong>Another one</strong>, Since have learned that one pixel can be seen as a little square. and the center of the pixel is (x + 0.5,y + 0.5); I tried this experiment using OpenCV, and found that : the result shows that they represent the same pixel.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.at&lt;cv::Vec3b&gt;(<span class="number">1</span>,<span class="number">1</span>)[<span class="number">1</span>] = <span class="number">255</span></span><br><span class="line">window.at&lt;cv::Vec3b&gt;(<span class="number">1</span>,<span class="number">1.9</span>)[<span class="number">1</span>] = <span class="number">255</span></span><br></pre></td></tr></table></figure>

<hr>
<p>References:<br>[1]3D Math Primer for Graphics and Game Development 2nd Edition.<br>[2]Fundamentals of Computer Graphics and 3rd Edition.<br>[3]Unity+Shader入门精要<br>[4]<a href="https://docs.unity3d.com/Manual/index.html">Unity3d Mannual</a><br>[5]<a href="http://games-cn.org/graphics-intro-ppt-video/">GAMES</a><br>[6]<a href="https://www.scratchapixel.com/">scratchapixel</a></p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Rendering/" rel="tag">Rendering</a>
                </div>
            </div>
        </div>
        
        
        
        
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='//platform-api.sharethis.com/js/sharethis.js#property=5e58d41ecdbda60012fcd87d&amp;product=inline-share-buttons&amp;cms=sop' async='async'></script>

        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>Alipay</span>
    <div class="qrcode"><img src="/images/Alipay.jpg" alt="Alipay"></div>
</a>

                
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>Wechat</span>
    <div class="qrcode"><img src="/images/Wechatpay.jpg" alt="Wechat"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/CS/Advanced-CPP/STL-Address-Opereator/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">address-opereator</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/CS/Advanced-CPP/STL-FunctionTemplate/">
                <span class="level-item">Function-Template</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: 'f7d6d05297c7a1b94ee1',
        clientSecret: 'f3c964e1d94edd347ea044c1bc1ecdadac432326',
        id: '17d1ad3d2ff1c85275575b6711c74d38',
        repo: 'keneyr.github.io',
        owner: 'Keneyr',
        admin: "Keneyr",
        createIssueManually: false,
        distractionFreeMode: false
    })
    gitalk.render('comment-container')
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-2-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/anna.jpg" alt="Anna">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Anna
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Game Programmer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shanghai,China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            91
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            21
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            16
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/Keneyr" target="_blank" rel="noopener">
                Follow</a>
        </div>
        
        
        
    </div>
</div>
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    Catalogue
                </h3>
                <ul class="menu-list"><ul class="menu-list"><li>
        <a class="is-flex" href="#How-to-Understand-Shading">
        <span class="has-mr-6">1.1</span>
        <span>How to Understand Shading?</span>
        </a></li><li>
        <a class="is-flex" href="#The-Standard-Local-Lighting-Model">
        <span class="has-mr-6">1.2</span>
        <span>The Standard Local Lighting Model</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#The-Standard-Lighting-Equation-Overview">
        <span class="has-mr-6">1.2.1</span>
        <span>The Standard Lighting Equation Overview</span>
        </a></li><li>
        <a class="is-flex" href="#The-Ambient-and-Emmisive-Components">
        <span class="has-mr-6">1.2.2</span>
        <span>The Ambient and Emmisive Components</span>
        </a></li><li>
        <a class="is-flex" href="#The-Diffuse-Component">
        <span class="has-mr-6">1.2.3</span>
        <span>The Diffuse Component</span>
        </a></li><li>
        <a class="is-flex" href="#The-Specular-Component">
        <span class="has-mr-6">1.2.4</span>
        <span>The Specular Component</span>
        </a></li><li>
        <a class="is-flex" href="#Limitations-of-the-Standard-Model">
        <span class="has-mr-6">1.2.5</span>
        <span>Limitations of the Standard Model</span>
        </a></li><li>
        <a class="is-flex" href="#Flat-amp-Gouraud-Shading">
        <span class="has-mr-6">1.2.6</span>
        <span>Flat & Gouraud Shading</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Light-Sources">
        <span class="has-mr-6">1.3</span>
        <span>Light Sources</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Standard-Abstract-Light-Types">
        <span class="has-mr-6">1.3.1</span>
        <span>Standard Abstract Light Types</span>
        </a></li><li>
        <a class="is-flex" href="#Light-Attenuation">
        <span class="has-mr-6">1.3.2</span>
        <span>Light Attenuation</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Texture-Mapping">
        <span class="has-mr-6">1.4</span>
        <span>Texture Mapping</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#What-is-a-Texture">
        <span class="has-mr-6">1.4.1</span>
        <span>What is a Texture?</span>
        </a></li><li>
        <a class="is-flex" href="#Texture-Magnification">
        <span class="has-mr-6">1.4.2</span>
        <span>Texture Magnification</span>
        </a></li><li>
        <a class="is-flex" href="#Different-Types-Texture-Mapping">
        <span class="has-mr-6">1.4.3</span>
        <span>Different Types Texture Mapping</span>
        </a></li><li>
        <a class="is-flex" href="#Opacity-Blending">
        <span class="has-mr-6">1.4.4</span>
        <span>Opacity Blending</span>
        </a></li></ul></li></ul><li>
        <a class="is-flex" href="#Appendix">
        <span class="has-mr-6">2</span>
        <span>Appendix:</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#PBS">
        <span class="has-mr-6">2.1</span>
        <span>PBS</span>
        </a></li><li>
        <a class="is-flex" href="#Interpolation">
        <span class="has-mr-6">2.2</span>
        <span>Interpolation</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Why-do-we-want-interplate">
        <span class="has-mr-6">2.2.1</span>
        <span>Why do we want interplate?</span>
        </a></li><li>
        <a class="is-flex" href="#What-do-we-want-to-interpolate">
        <span class="has-mr-6">2.2.2</span>
        <span>What do we want to interpolate?</span>
        </a></li><li>
        <a class="is-flex" href="#Barycentric-Coordinates-Formulas">
        <span class="has-mr-6">2.2.3</span>
        <span>Barycentric Coordinates: Formulas</span>
        </a></li><li>
        <a class="is-flex" href="#Using-Barycentric-Coordinates">
        <span class="has-mr-6">2.2.4</span>
        <span>Using Barycentric Coordinates</span>
        </a></li><li>
        <a class="is-flex" href="#Bilinear-Interpolation">
        <span class="has-mr-6">2.2.5</span>
        <span>Bilinear Interpolation</span>
        </a></li></ul></li></ul></li></ul>
            </div>
        </div>
    </div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://www.youtube.com/@Gdconf/videos" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">GDC</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.youtube.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.esports.net/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Esports</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.esports.net</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.blender.org/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">blender</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.blender.org</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://dl.acm.org/topic/ccs2012/10010147.10010371.10010352" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">acmLibrary</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">dl.acm.org</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.physicsbasedanimation.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">physicalAnimation</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.physicsbasedanimation.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://graphics.pixar.com/research/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Pixar Studio</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">graphics.pixar.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.ubisoft.com/en-us/studio/laforge" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Ubisoft Studio</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.ubisoft.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://theorangeduck.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Daniel Holden</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">theorangeduck.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://artanim.ch/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">artanim</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">artanim.ch</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.ode.org/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">ODE</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.ode.org</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/NVIDIAGameWorks/PhysX/tree/4.1" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">PhysX</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/google-deepmind/mujoco" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">mujoco</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://rodolphe-vaillant.fr/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">rodolphe</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">rodolphe-vaillant.fr</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://arrowinmyknee.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">arrowinmyknee</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">arrowinmyknee.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.3dgep.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">3dgep</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.3dgep.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="http://www.library.fudan.edu.cn/wjzx/2019njybgjskt/list1.htm" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">excellentMathBooks</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.library.fudan.edu.cn</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.deeplearningbook.org/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">DeepLearningBook</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.deeplearningbook.org</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="http://dpkingma.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Probability Model</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">dpkingma.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/CS/">
            <span class="level-start">
                <span class="level-item">CS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/CS/Advanced-CPP/">
            <span class="level-start">
                <span class="level-item">Advanced CPP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/CS/Algorithms/">
            <span class="level-start">
                <span class="level-item">Algorithms</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/GameProgramming/">
            <span class="level-start">
                <span class="level-item">GameProgramming</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/GameProgramming/System/">
            <span class="level-start">
                <span class="level-item">System</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Graphics/">
            <span class="level-start">
                <span class="level-item">Graphics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Graphics/Animation/">
            <span class="level-start">
                <span class="level-item">Animation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Graphics/Geometry/">
            <span class="level-start">
                <span class="level-item">Geometry</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Graphics/Rendering/">
            <span class="level-start">
                <span class="level-item">Rendering</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/MachineLearning/">
            <span class="level-start">
                <span class="level-item">MachineLearning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/MachineLearning/PatternRecognition/">
            <span class="level-start">
                <span class="level-item">PatternRecognition</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Math/">
            <span class="level-start">
                <span class="level-item">Math</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">41</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Math/Calculus/">
            <span class="level-start">
                <span class="level-item">Calculus</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">17</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Math/Linear-Algebra/">
            <span class="level-start">
                <span class="level-item">Linear Algebra</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Math/Numerical-Analysis/">
            <span class="level-start">
                <span class="level-item">Numerical Analysis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">14</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Math/Variation/">
            <span class="level-start">
                <span class="level-item">Variation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Paper/">
            <span class="level-start">
                <span class="level-item">Paper</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Paper/Human-Pose/">
            <span class="level-start">
                <span class="level-item">Human Pose</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Paper/Motion-Control/">
            <span class="level-start">
                <span class="level-item">Motion Control</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Paper/Motion-Generation/">
            <span class="level-start">
                <span class="level-item">Motion Generation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Paper/Sketch/">
            <span class="level-start">
                <span class="level-item">Sketch</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/Algorithms/" style="font-size: 10px;">Algorithms</a> <a href="/tags/Animation/" style="font-size: 17.14px;">Animation</a> <a href="/tags/CPP/" style="font-size: 12.86px;">CPP</a> <a href="/tags/Calculus/" style="font-size: 20px;">Calculus</a> <a href="/tags/GameProgramming/" style="font-size: 14.29px;">GameProgramming</a> <a href="/tags/Geometry/" style="font-size: 12.86px;">Geometry</a> <a href="/tags/Human-Pose/" style="font-size: 11.43px;">Human Pose</a> <a href="/tags/Linear-Algebra/" style="font-size: 15.71px;">Linear Algebra</a> <a href="/tags/MachineLearning/" style="font-size: 18.57px;">MachineLearning</a> <a href="/tags/Motion-Control/" style="font-size: 10px;">Motion Control</a> <a href="/tags/Motion-Generation/" style="font-size: 10px;">Motion Generation</a> <a href="/tags/Numerical-Analysis/" style="font-size: 18.57px;">Numerical Analysis</a> <a href="/tags/Rendering/" style="font-size: 12.86px;">Rendering</a> <a href="/tags/Sketch/" style="font-size: 12.86px;">Sketch</a> <a href="/tags/Sketh/" style="font-size: 11.43px;">Sketh</a> <a href="/tags/Variation/" style="font-size: 10px;">Variation</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2024-02-21T07:49:31.000Z">2024-02-21</time></div>
                    <a href="/Paper/Motion-Control/Paper-Learned-Motion-Matching/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Paper-Learned-Motion-Matching</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Paper/">Paper</a> / <a class="has-link-grey -link" href="/categories/Paper/Motion-Control/">Motion Control</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2024-01-22T04:29:46.000Z">2024-01-22</time></div>
                    <a href="/Paper/Human-Pose/Paper-MAPConNet-SelfSupervised-3D-Pose-Transfer-with-Mesh-and-Point-ConstrastiveLearning/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Paper-MAPConNet-SelfSupervised-3D-Pose-Transfer-with-Mesh-and-Point-ConstrastiveLearning</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Paper/">Paper</a> / <a class="has-link-grey -link" href="/categories/Paper/Human-Pose/">Human Pose</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2023-12-28T04:27:50.000Z">2023-12-28</time></div>
                    <a href="/CS/Algorithms/Algorithms-C1-Foundations/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Algorithms-C1-Foundations</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/CS/">CS</a> / <a class="has-link-grey -link" href="/categories/CS/Algorithms/">Algorithms</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2023-11-15T07:01:37.000Z">2023-11-15</time></div>
                    <a href="/Graphics/Animation/Animation-C14-Skinning/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Animation-C14-Skinning</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Graphics/">Graphics</a> / <a class="has-link-grey -link" href="/categories/Graphics/Animation/">Animation</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2023-11-14T07:38:58.000Z">2023-11-14</time></div>
                    <a href="/Graphics/Animation/Animation-C13-Learning-based-Animation/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Animation-C13-Learning-based-Animation</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Graphics/">Graphics</a> / <a class="has-link-grey -link" href="/categories/Graphics/Animation/">Animation</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2024/02/">
                <span class="level-start">
                    <span class="level-item">February 2024</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2024/01/">
                <span class="level-start">
                    <span class="level-item">January 2024</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2023/12/">
                <span class="level-start">
                    <span class="level-item">December 2023</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2023/11/">
                <span class="level-start">
                    <span class="level-item">November 2023</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">18</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2023/10/">
                <span class="level-start">
                    <span class="level-item">October 2023</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">51</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2023/09/">
                <span class="level-start">
                    <span class="level-item">September 2023</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2023/04/">
                <span class="level-start">
                    <span class="level-item">April 2023</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/04/">
                <span class="level-start">
                    <span class="level-item">April 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">March 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Algorithms/">
                        <span class="tag">Algorithms</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Animation/">
                        <span class="tag">Animation</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CPP/">
                        <span class="tag">CPP</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Calculus/">
                        <span class="tag">Calculus</span>
                        <span class="tag is-grey">17</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/GameProgramming/">
                        <span class="tag">GameProgramming</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Geometry/">
                        <span class="tag">Geometry</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Human-Pose/">
                        <span class="tag">Human Pose</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Linear-Algebra/">
                        <span class="tag">Linear Algebra</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MachineLearning/">
                        <span class="tag">MachineLearning</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Motion-Control/">
                        <span class="tag">Motion Control</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Motion-Generation/">
                        <span class="tag">Motion Generation</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Numerical-Analysis/">
                        <span class="tag">Numerical Analysis</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Rendering/">
                        <span class="tag">Rendering</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Sketch/">
                        <span class="tag">Sketch</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Sketh/">
                        <span class="tag">Sketh</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Variation/">
                        <span class="tag">Variation</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/beauty.jpg" alt="Rendering-Lighting-Shading-Texture" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2024 Keneyr&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>

                <span id="busuanzi_container_site_pv" class="theme-info">
                    | PageView: <span id="busuanzi_value_site_pv">span>
                    </span>

                
            <br><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("2/28/2020 12:49:00");//此处修改你的建站时间或者网站上线时间 
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "The site has been running "+dnum+" days "; 
        document.getElementById("times").innerHTML = hnum + " hours " + mnum + " minutes " + snum + " seconds"; 
    } 
setInterval("createtime()",250);
</script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://keneyr.com',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
<script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
      document.write('<script type="text/javascript" src="/js/src/snow.js"><\/script>');
    }
</script>  
</html>